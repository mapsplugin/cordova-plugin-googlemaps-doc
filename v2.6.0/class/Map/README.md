:green_heart: This is the latest document.

# Map class

_This class extends [BaseClass](../BaseClass/README.md)_.

## Contents

  - <a href="#overview">Overview</a>
    - <a href="#create-a-map">Create a map</a>
    - <a href="#how-does-the-plugin-work">How does the plugin work</a>
    - <a href="#events">Events</a>
    - <a href="#camera">Camera</a>
  - <a href="#api-reference">API Reference</a>

------------

## Overview


### Create a map

You can create a google maps (`map instance`) using  [`plugin.google.maps.Map.getMap()`](./getMap/README.md) **after the deviceready** event.


```js
document.addEventListener("deviceready", function() {
  // Define a div tag with id="map_canvas"
  var mapDiv = document.getElementById("map_canvas");

  // Initialize the map plugin
  var map = plugin.google.maps.Map.getMap(mapDiv);

  // The MAP_READY event notifies the native map view is fully ready to use.
  map.one(plugin.google.maps.event.MAP_READY, onMapInit);
});

function onMapInit(map) {

}
```

<img src="./embed_map.gif" width="150">

------------

### How does the plugin work?

Before using this plugin, please understand how this plugin work.

- #### _App background becomes `transparent`_

  This plugin embeds `native Google Maps view` **under the browser view**.
  Because of this, this plugin changes the application background as `transparent`. If you want to set the background color, you need to use [Environment.setBackgroundColor()](../Environment/setBackgroundColor/README.md).

  <img src="./mechanism.png" width="250">

- #### _Map is not HTML element!_

  The Google Maps generated by this plugin is **not HTML element**.
  You **CAN NOT** do like this:
  ```js
  map.appendChild(button);
  ```

- #### _Positioning is delay a little_

  Positioning is one of the difficult task. Since the map is not in the browser, the plugin follows the map div position and size
  when you manipulate the your app.
  Because of this, the map follows the map div position with little delay.

  If you are not acceptable, please use alternative solutions, such as [Google Maps JavaScript API v3](https://developers.google.com/maps/documentation/javascript/) or [MapBox](https://www.mapbox.com/).

  ![](./positioning.gif)

- #### _Manipulate like a HTML element!_

  The biggest benefit of this plugin is **you can put/cover any HTML elements on the map, just like HTML!**

  The maps plugin recognizes all touches before browser, calculates who should receive the touch event, then pass it.

  <img src="./touch.png" width="300">

- #### _What's camera?_

  The native Google Map APIs have a 3D map internally. We can only see the map through the camera.

  <img src="./camera.gif" width="150">

------------

### Events

- #### User interface events

  A map instance tells us what UI changes are occurred through these events:
  - MAP_READY
  - MAP_CLICK
  - MAP_LONG_CLICK
  - CAMERA_MOVE_START (including map dragging)
  - CAMERA_MOVE
  - CAMERA_MOVE_END
  - MY_LOCATION_BUTTON_CLICK
  - MY_LOCATION_CLICK
  - POI_CLICK

  The above events passes with event information in parameter, such as where is clicked.

  ```js
  map.on(plugin.google.maps.event.MAP_CLICK, function(latLng) {
    alert(latLng + " is clicked!");
  });
  ```

  And also, event listener is involved with the instance of the map.
  This allows you to write your event listener code in a separate place.

  ```js
  map.on(plugin.google.maps.event.MAP_CLICK, onMapClick);

  function onMapClick(latLng) {
    var map = this;

    map.addMarker({
      position: latLng
    });
  }
  ```

- #### MVC status change events

  The `map` class extends [BaseClass](../BaseClass/README.md).
  The `BaseClass` has `set()` and `get()` methods.
  This is very useful methods.

  If you set a value through `set()` method, you can listen the `(key)_changed` event.

  <a href="mvc_status_change_event.png"><img src="./mvc_status_change_event.png" width="450"></a>

  The benefit of this is you can write your code `Model-View-Controller` separately.

  ```js
  map.on(plugin.google.maps.event.MAP_CLICK, function(latLng) {
    map.set("clickPosition", latLng);
  });

  map.on("clickPosition_changed", function() {
    var clickPosition = this.get("clickPosition");
  });
  ```

------------

### Camera

- #### Changing the camera position

  This plugin has two basic methods:

  - `map.animateCamera()` changes the camera position **with animation**.
  - `map.moveCamera()` changes the camera position **without animation**.

  ```js
  map.animateCamera({
    target: {lat: 37.422359, lng: -122.084344},
    zoom: 17,
    tilt: 60,
    bearing: 140,
    duration: 5000
  }, function() {
    //alert("Camera target has been changed");
  });
  ```

  <a href="./animateCamera/image.gif"><img src="animateCamera/image.gif" width="150"></a>

  Other methods `animateCameraZoomIn()`, `moveCameraZoomIn()`, `setCameraTarget()`...etc use one of the above methods internally.

  Since this plugin stops other methods execution during the camera moving, this is bad performance code.

  **Bad performance code**
  ```js
  map.setCameraZoom(10);
  map.setCameraTilt(30);
  map.setCameraBearing(45);
  ```

  Recommended way is using one method as much as possible.

  **Good performance code**
  ```js
  map.moveCamera({
    zoom: 10,
    tilt: 30,
    bearing: 45
  });
  ```

- #### Get the camera position

  You can get the camera position through these method anytime.
  - `map.getCameraPosition()` // Returns `center`, `zoom`, `bearing`, and `tilt` values
  - `map.getCameraZoom()`
  - `map.getCameraTarget()`
  - `map.getCameraBearing()`
  - `map.getCameraTilt()`

  Also you can listen the `CAMERA_MOVE` events.
  ```js
  map.on(plugin.google.maps.event.CAMERA_MOVE, function(cameraPosition) {
    console.log(cameraPosition.target);
  });
  ```

  If you want to listen particular property, you can do like this:
  ```js
  map.on('camera_target_changed', function(latLng) {
    console.log("map center = " + latLng);
  });
  ```

------------

## API reference

### Create

<table>
    <tr>
        <th><a href="./getMap/README.md">getMap()</a></th>
        <td>Gets a new map class instance.</td>
    </tr>
</table>

### Methods

<table >
    <tr>
        <th><a href="./setDiv/README.md">setDiv()</a></th>
        <td>Changes the map div.</td>
    </tr>
    <tr>
        <th>getDiv()</th>
        <td>Returns the map div.</td>
    </tr>
    <tr>
        <th><a href="./setMapTypeId/README.md">setMapTypeId()</a></th>
        <td>Changes the map type id.</td>
    </tr>
    <tr>
        <th><a href="./animateCamera/README.md">animateCamera()</a></th>
        <td>Moves the camera <b>with animation</b>.</td>
    </tr>
    <tr>
        <th><a href="./animateCameraZoomIn/README.md">animateCameraZoomIn()</a></th>
        <td>Zooming in the camera <b>with animation</b>.</td>
    </tr>
    <tr>
        <th><a href="./animateCameraZoomOut/README.md">animateCameraZoomOut()</a></th>
        <td>Zooming out the camera <b>with animation</b>.</td>
    </tr>
    <tr>
        <th><a href="./moveCamera/README.md">moveCamera()</a></th>
        <td>Moves the camera <b>without animation</b>.</td>
    </tr>
    <tr>
        <th><a href="./moveCameraZoomIn/README.md">moveCameraZoomIn()</a></th>
        <td>Zooming in the camera <b>without animation</b>.</td>
    </tr>
    <tr>
        <th><a href="./moveCameraZoomOut/README.md">moveCameraZoomOut()</a></th>
        <td>Zooming out the camera <b>without animation</b>.</td>
    </tr>
    <tr>
        <th><a href="./getCameraPosition/README.md">getCameraPosition()</a></th>
        <td>Get the current camera position, including the target, zoom, tilt and bearing.</td>
    </tr>
    <tr>
        <th><a href="./getCameraTarget/README.md">getCameraTarget()</a></th>
        <td>Get the current camera target position.</td>
    </tr>
    <tr>
        <th><a href="./getCameraZoom/README.md">getCameraZoom()</a></th>
        <td>Get the current camera zoom level.</td>
    </tr>
    <tr>
        <th><a href="./getCameraBearing/README.md">getCameraBearing()</a></th>
        <td>Get the current camera bearing.</td>
    </tr>
    <tr>
        <th><a href="./getCameraTilt/README.md">getCameraTilt()</a></th>
        <td>Get the current camera tilt (view angle).</td>
    </tr>
    <tr>
        <th><a href="./setCameraTarget/README.md">setCameraTarget()</a></th>
        <td>Set the center position of the camera view.</td>
    </tr>
    <tr>
        <th><a href="./setCameraZoom/README.md">setCameraZoom()</a></th>
        <td>Set zoom level of the camera.</td>
    </tr>
    <tr>
        <th><a href="./setCameraTilt/README.md">setCameraTilt()</a></th>
        <td>Set the camera view angle.</td>
    </tr>
    <tr>
        <th><a href="./setCameraBearing/README.md">setCameraBearing()</a></th>
        <td>Set the camera bearing.</td>
    </tr>
    <tr>
        <th><a href="./panBy/README.md">panBy()</a></th>
        <td>Change the center of the map by the given distance in pixels.</td>
    </tr>
    <tr>
        <th><a href="./getVisibleRegion/README.md">getVisibleRegion()</a></th>
        <td>Get the current visible region (sw and ne).</td>
    </tr>
    <tr>
        <th><a href="./getMyLocation/README.md">getMyLocation()</a></th>
        <td>Get the current device location.</td>
    </tr>
    <tr>
        <th><a href="./setClickable/README.md">setClickable()</a></th>
        <td>Set false to ignore all clicks on the map.</td>
    </tr>
    <tr>
        <th><a href="./remove/README.md">remove()</a></th>
        <td>Destroy a map completely.</td>
    </tr>
    <tr>
        <th><a href="./clear/README.md">clear()</a></th>
        <td>Remove all overlays, such as marker.</td>
    </tr>
    <tr>
        <th><a href="./fromLatLngToPoint/README.md">fromLatLngToPoint()</a></th>
        <td>Convert the unit from LatLng to the pixels from the left/top of the map div.</td>
    </tr>
    <tr>
        <th><a href="./fromPointToLatLng/README.md">fromPointToLatLng()</a></th>
        <td>Convert the unit from the pixels from the left/top to the LatLng.</td>
    </tr>
    <tr>
        <th><a href="./setMyLocationButtonEnabled/README.md">setMyLocationButtonEnabled()</a></th>
        <td>Set true if you want to show the MyLocation button.</td>
    </tr>
    <tr>
        <th><a href="./setMyLocationEnabled/README.md">setMyLocationEnabled()</a></th>
        <td>Set true if you want to show the MyLocation control (blue dot).</td>
    </tr>
    <tr>
        <th><a href="./getFocusedBuilding/README.md">getFocusedBuilding()</a></th>
        <td>Get the currently focused building.</td>
    </tr>
    <tr>
        <th><a href="./setIndoorEnabled/README.md">setIndoorEnabled()</a></th>
        <td>Set true if you want to show the indoor map.</td>
    </tr>
    <tr>
        <th><a href="./setTrafficEnabled/README.md">setTrafficEnabled()</a></th>
        <td>Set true if you want to show the traffic layer.</td>
    </tr>
    <tr>
        <th><a href="./setCompassEnabled/README.md">setCompassEnabled()</a></th>
        <td>Set true if you want to show the compass button.</td>
    </tr>
    <tr>
        <th><a href="./setAllGesturesEnabled/README.md">setAllGesturesEnabled()</a></th>
        <td>Sets the preference for whether all gestures should be enabled or disabled.</td>
    </tr>
    <tr>
        <th><a href="./setVisible/README.md">setVisible()</a></th>
        <td>Set visibility of the map.</td>
    </tr>
    <tr>
        <th><a href="./setPadding/README.md">setPadding()</a></th>
        <td>Adjust the map padding.</td>
    </tr>
    <tr>
        <th><a href="./setOptions/README.md">setOptions()</a></th>
        <td>Change the map options.</td>
    </tr>
    <tr>
        <th><a href="./toDataURL/README.md">toDataURL()</a></th>
        <td>Generate the map screen capture image as base64 encoded data, like HTML5's Canvas.</td>
    </tr>
    <tr>
        <th><a href="../Marker/addMarker/README.md">map.addMarker()</a></th>
        <td>Add a <a href="../Marker/README.md">marker</a>.</td>
    </tr>
    <tr>
        <th><a href="../Polyline/addPolyline/README.md">map.addPolyline()</a></th>
        <td>Add a <a href="../Polyline/README.md">polyline</a>.</td>
    </tr>
    <tr>
        <th><a href="../Polygon/addPolygon/README.md">map.addPolygon()</a></th>
        <td>Add a <a href="../Polygon/README.md">polygon</a>.</td>
    </tr>
    <tr>
        <th><a href="../Circle/addCircle/README.md">map.addCircle()</a></th>
        <td>Add a <a href="../Circle/README.md">circle</a>.</td>
    </tr>
    <tr>
        <th><a href="../GroundOverlay/addGroundOverlay/README.md">map.addGroundOverlay()</a></th>
        <td>Add a <a href="../GroundOverlay/README.md">ground overlay</a>.</td>
    </tr>
    <tr>
        <th><a href="../TileLayer/addTileLayer/README.md">map.addTileLayer()</a></th>
        <td>Add <a href="../TileLayer/README.md">tile layer</a>.</td>
    </tr>
    <tr>
        <th><a href="../KmlOverlay/addKmlLayer/README.md">map.addKmlOverlay()</a></th>
        <td>Add <a href="../KmlOverlay/README.md">kml layer</a>.</td>
    </tr>
</table>

### Events
<table class="reference">
    <tr>
        <th><a href="./MAP_CLICK/README.md">MAP_CLICK</a></th>
        <td>This event is fired when you click on the map.</td>
    </tr>
    <tr>
        <th><a href="./MAP_LONG_CLICK/README.md">MAP_LONG_CLICK</a></th>
        <td>This event is fired when you press your finger a few seconds on the map.</td>
    </tr>
    <tr>
        <th><a href="./MY_LOCATION_BUTTON_CLICK/README.md">MY_LOCATION_BUTTON_CLICK</a></th>
        <td>This event is fired when you tap on the location button.</td>
    </tr>
    <tr>
        <th><a href="./MY_LOCATION_CLICK/README.md">MY_LOCATION_CLICK</a></th>
        <td>This event is fired when you tap on the location control (blue dot).</td>
    </tr>
    <tr>
        <th><a href="./POI_CLICK/README.md">POI_CLICK</a></th>
        <td>This event is fired when you tap on POIs(such as building icon).</td>
    </tr>
    <tr>
        <th><a href="./CAMERA_EVENTS/README.md">CAMERA_MOVE_START<BR>CAMERA_MOVE<br>CAMERA_MOVE_END</a></th>
        <td>This events are fired when the camera moves.</td>
    </tr>
    <tr>
        <th><a href="./MAP_DRAG_EVENTS/README.md">MAP_DRAG_START<BR>MAP_DRAG<br>MAP_DRAG_END</a></th>
        <td>This events are fired when the camera moves with gestures.</td>
    </tr>
    <tr>
        <th><a href="./MAP_READY/README.md">MAP_READY</a></th>
        <td>This event is fired when the map is created using the <a href="./getMap/README.md">map.getMap()</a> method.</td>
    </tr>
</table>
